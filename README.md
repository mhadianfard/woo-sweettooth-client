Sweet Tooth Client for WooCommerce (Beta)
====================================

This project was created to demonstrate a **proof of concept** prototype for integrating [WooCommerce](http://www.woothemes.com/woocommerce/) with the [Sweet Tooth Loyalty API](http://www.sweettoothloyalty.com/) (currently in beta). The repository contains a WordPress plugin, `woo-sweettooth-client`, which although fully functional, is *not* recommended for production use as is.

Requirements
--------------------
WordPress and WooCommerce are required for this plugin.
This has been developed and tested on WordPress 3.6.1 with WooCommerce 2.0.14. See [technologies](#technologies) section for more details.

[Pest RESTful Client](https://github.com/educoder/pest) is also required. This has already been added as a sub-module to this repo.
Setup
---------
1. Clone this repository and update sub-modules to get Pest.
2.  Manually install plugin into `wp-content/plugins/woo-sweettooth-client` ([instructions](http://codex.wordpress.org/Managing_Plugins#Manual_Plugin_Installation))
3.  Modify lines *18* and *25* of `ApiClient.php` to add in your API credentials obtained from [sweettoothloyalty.com](http://www.sweettoothloyalty.com)
4. Modify function `setupRedemptionOptions()` in `RedemptionClient.php` as needed.
5. Make sure you've **Activated** the plugin (from step1).


Features
------------
* Send customer and order details to Sweet Tooth servers, once an order is marked complete.
* Query logged-in customer points balances from the Sweet Tooth server and display through WordPress shortcodes.
* Define point redemption options and offer discounts through WooCommerce coupons.

Documentation
------------------
The entire code-base contains PHPDoc comments and in-line documentation. Every class, function and variable has these.

Known Issues & Missing Implementations
-------------------------------------------------------------
* **There is no admin-facing user interface implemented.**  
 In the interest of time API Crednetials as well as Redemption Options were hard-coded into the the plugin. This is generally bad practice and should be done through the interface and stored in the database somewhere.

* **Remote Customer IDs are not stored locally.**  
 Customer look-ups are done by *email* at the moment which is **never** a good idea in case customer changes their email address. To solve this, remote customer IDs from the server should be stored and associated with a WP User locally. This can be done by explicitly creating remote customers alongside local customer accounts or by listening to responses when sending `events` to the Sweet Tooth server.  
 In addition, it's a great idea to update remote customer data, whenever it happens to change locally ([here's how](http://codex.wordpress.org/Plugin_API/Action_Reference/profile_update)).

* **No checks on coupon code creation success.**  
Currently coupon codes are generated by Base64 encoding `time()` in php. The odds of collision are low here unless two coupons are somehow created at the same second. There is currently no extra safety checks to verify the success of creating a coupon in WooCommerce.

* **No stylesheets or HTML Templates**  
Bad practice to hard-code HTML without proper templates. Even worse is to add CSS styles to them. We had to do that in a couple of places. They should be extracted into separate files.

* **Debug statements**  
We've intentionally left in some debug statements when making calls to the server so that you can make sure you minimize the number of calls to the server.

Support
-----------
This plugin is released as an open-source project and not actively maintained by [Sweet Tooth Inc.](http://www.sweettoothhq.com) or anyone else except for the open-source community.

<a name="Technologies" style="color: black">Technologies</a>
-------------------------------------------------
**Libraries Used:**

* jQuery (pre-bundled with WordPress)
* [Pest RESTful Client](https://github.com/educoder/pest) (Git sub-module)

WordPress features used:
<pre>
- add_action (available since 1.2)
- add_shortcode (available since 2.5)
- shortcode_atts (available since 2.5)
- wp_enqueue_script (available since 2.6)
- wp_insert_post (available since 1.0)
- update_post_meta (available since 1.5)
- wp_localize_script
- wp_ajax_* actions
</pre>

List of WooCommerce features used:
<pre>
- woocommerce_order_status_completed action
- WC_Order class
- shop_coupon post_type
</pre>